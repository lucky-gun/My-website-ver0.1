[Definition]
datepattern = ^.*"time":"{ISO8601}"

# 민감경로 + ACME 트래버설(정규화된 /etc/passwd 포함) 한 줄로 통합
failregex = ^\{.*"(?:ClientHost|ClientAddr)"\s*:\s*"<HOST>".*(?=.*"(?:RequestPath|Path)"\s*:\s*"(?:/(?:\.env|\.git(?:/HEAD)?|\.DS_Store|id_rsa|passwd|etc/passwd|backup(?:\.zip|\.tar(?:\.gz)?)?|config\.php|dump\.sql|webconfig\.txt|phpinfo\.php|wp-config\.php|vendor/phpunit|phpunit\.phar|phpmyadmin|pma|adminer|admin|setup\.php|installer\.php|console|actuator|hudson|jenkins|HNAP1|boaform|wls-wsat)(?:/|[^"]*)?|/\.well-known/acme-challenge/(?:[^"]*(?:\.\.|%%2[eE]%%2[eE]|%%2[fF]|//)[^"]*))")(?=.*"(?:DownstreamStatus|status)"\s*:\s*40\d).*$

ignoreregex =
    # 정상 ACME 토큰만 면제: base64url 문자셋( . 없음 ), 길이 1~256 허용
    ^\{.*"(?:RequestPath|Path)"\s*:\s*"/\.well-known/acme-challenge/[A-Za-z0-9_-]{1,256}"[^"]*".*$
    # xmlrpc는 ModSecurity가 전담(중복 차단 방지)
    ^\{.*"(?:RequestPath|Path)"\s*:\s*"/xmlrpc\.php".*$
