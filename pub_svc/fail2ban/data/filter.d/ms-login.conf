# /etc/fail2ban/filter.d/ms-login-detect.conf
[Definition]
maxlines = 100
datepattern = ^.*"time":"{ISO8601}"

failregex =
    # WordPress GUI
    ^\{.*"client_ip"\s*:\s*"<HOST>".*(?=.*"uri"\s*:\s*"/wp-login\.php"(?:\?[^"]*)?)(?=.*"ruleId"\s*:\s*"(?:9421\d{2}|941100|93010\d)").*$
    # MediaWiki (Special:UserLogin)
    ^\{.*"client_ip"\s*:\s*"<HOST>".*(?=.*"uri"\s*:\s*"/(?:w|mediawiki)/index\.php"(?:\?[^"]*title=Special:UserLogin[^"]*)?)(?=.*"ruleId"\s*:\s*"(?:9421\d{2}|941100|93010\d)").*$
    # Grafana / Nextcloud : /login 또는 /index.php/login 모두 허용  ← (오타 수정: \s*"/login")
    ^\{.*"client_ip"\s*:\s*"<HOST>".*(?=.*"uri"\s*:\s*"/(?:index\.php/)?login"(?:\?[^"]*)?)(?=.*"ruleId"\s*:\s*"(?:9421\d{2}|941100|93010\d)").*$

ignoreregex =
